# 9-1 元件清單及其規格描述

**專案名稱**：FreshLog (食價登錄)
**版本**：v1.0.0
**文件日期**：2025-10-27
**技術棧**：Vue 3.5.13 + Vite 6.2.0 + Pinia 3.0.1 + Vue Router 4.5.0

---

## 目錄

1. [專案概述](#1-專案概述)
2. [全域佈局元件](#2-全域佈局元件)
3. [首頁儀表板元件](#3-首頁儀表板元件)
4. [蔬菜詳情頁元件](#4-蔬菜詳情頁元件)
5. [食譜詳情頁元件](#5-食譜詳情頁元件)
6. [共用元件](#6-共用元件)
7. [技術規格說明](#7-技術規格說明)

---

## 1. 專案概述

### 1.1 專案簡介

FreshLog (食價登錄) 是一個農產品價格追蹤與食譜推薦的綜合性 Web 應用程式,旨在幫助消費者與農民掌握市場價格趨勢、瀏覽營養食譜,並管理個人收藏與偏好設定。

### 1.2 主要功能

- **價格追蹤**:即時查詢蔬果市場價格、歷史趨勢圖表、多市場比價
- **食譜瀏覽**:食譜搜尋、篩選、分類瀏覽、營養資訊查詢
- **會員系統**:註冊登入、個人資料管理、收藏管理、價格追蹤提醒
- **AI 推薦**:智慧食譜推薦、替代食材建議
- **響應式設計**:支援桌機、平板、手機多種裝置

### 1.3 使用者角色

- **消費者**:查詢蔬果價格、瀏覽食譜、收藏功能、價格追蹤
- **農民**:作物管理儀表板 (開發中)

### 1.4 元件組織架構

```
src/components/
├── Header.vue                    # 全域導航列
├── Footer.vue                    # 全域頁腳
├── Layout.vue                    # 主要佈局容器
├── RoleToggle.vue                # 角色切換按鈕
├── ConsumerHome/                 # 首頁儀表板元件
│   ├── Card.vue
│   ├── BrandHeroCard.vue
│   ├── MarketTrendCard.vue
│   ├── RecipeListCard.vue
│   ├── AgriCompositeIndexCard.vue
│   ├── NutritionHelperCard.vue
│   └── NewsCard.vue
├── Veggie/                       # 蔬菜詳情頁元件
│   ├── VeggieMainInfoCard.vue
│   ├── AveragePriceTrendChart.vue
│   ├── MultiMarketPriceCompareCard.vue
│   ├── NutritionInfoCard.vue
│   ├── SimilarVeggieCompareCard.vue
│   ├── RecipeRecommendCard.vue
│   ├── StorageTipsCard.vue
│   ├── AiSuggestionCard.vue
│   └── FarmerInfoCard.vue
├── Recipe/                       # 食譜詳情頁元件
│   ├── RecipeDetailHeader.vue
│   ├── IngredientsList.vue
│   ├── MainIngredientPrice.vue
│   ├── MainNutritionCard.vue
│   ├── RecipeSteps.vue
│   ├── SubstituteRecommendations.vue
│   ├── MarketTrends.vue
│   └── SeasonalRecommend.vue
└── CCC/                          # 共用/通用元件
    ├── CategoryTag.vue
    ├── MarketSight.vue
    ├── PageControls.vue
    ├── PageHeader.vue
    ├── Recipe.vue
    ├── Sidebar.vue
    └── RecipeList/
        ├── RecipeCard.vue
        ├── RecipeCategoryTags.vue
        ├── RecipeSideBar.vue
        └── Recommendation.vue
```

---

## 2. 全域佈局元件

### 2.1 Header.vue

**路徑**: `src/components/Header.vue`
**用途**: 全站通用導航列,包含 Logo、網站標題、導航連結、搜尋功能、會員登入/個人中心

#### 功能特性

1. **響應式導航**

   - 桌機版:水平導航列,顯示所有連結
   - 手機版:漢堡選單 (☰),點擊展開下拉選單

2. **智慧搜尋功能**

   - 即時自動完成建議 (autocomplete)
   - 分類顯示:蔬果/食譜
   - 支援中英文輸入 (IME composition event 處理)
   - 鍵盤導航:↑/↓ 選擇項目,Enter 確認
   - 滑鼠懸停高亮顯示
   - 點擊外部自動關閉下拉清單

3. **手機版搜尋模式**

   - 點擊放大鏡圖示進入搜尋模式
   - 搜尋列佔滿螢幕寬度
   - 顯示 X 按鈕關閉搜尋
   - 自動聚焦輸入框

4. **角色判斷顯示**

   - 根據 `userRole` 顯示對應導航項目
   - 消費者:首頁、蔬菜列表/內頁、食譜列表/內頁
   - 農民:農民儀表板 (待完善)

5. **會員狀態管理**
   - 未登入:顯示「註冊/登入」按鈕
   - 已登入:顯示「個人中心」按鈕 (含使用者圖示)

#### Props

無

#### Emits

無

#### 依賴

- **Pinia Store**: `useUserStore` (登入狀態、角色)
- **Router**: `useRoute`, `useRouter`, `RouterLink`
- **資料來源**: `@/data/searchIndex.js` (蔬果/食譜搜尋索引)

#### 主要狀態

| 狀態變數           | 型別           | 說明                     |
| ------------------ | -------------- | ------------------------ |
| `keyword`          | `ref<string>`  | 搜尋關鍵字               |
| `dropdownOpen`     | `ref<boolean>` | 下拉清單開啟狀態         |
| `activeIndex`      | `ref<number>`  | 鍵盤導航高亮索引         |
| `mobileSearchMode` | `ref<boolean>` | 手機版搜尋模式開關       |
| `showMenu`         | `ref<boolean>` | 手機版選單展開狀態       |
| `isMobile`         | `ref<boolean>` | 是否為手機裝置 (<=768px) |
| `isComposing`      | `ref<boolean>` | 中文輸入法組字狀態       |

#### 計算屬性

| 計算屬性       | 回傳型別                             | 說明                         |
| -------------- | ------------------------------------ | ---------------------------- |
| `suggestions`  | `{ veggies: array, recipes: array }` | 自動完成建議清單             |
| `flatList`     | `array`                              | 平展的建議清單 (蔬果+食譜)   |
| `showDropdown` | `boolean`                            | 是否顯示下拉清單             |
| `isLoggedIn`   | `boolean`                            | 是否已登入                   |
| `userRole`     | `string`                             | 使用者角色 (consumer/farmer) |
| `isConsumer`   | `boolean`                            | 是否為消費者角色             |

#### 主要方法

| 方法名稱                 | 參數           | 說明                     |
| ------------------------ | -------------- | ------------------------ |
| `onType(e)`              | Event          | 輸入時開啟下拉並重設高亮 |
| `onFocus()`              | -              | 聚焦時顯示下拉清單       |
| `onCompStart()`          | -              | IME 組字開始             |
| `onCompEnd(e)`           | Event          | IME 組字結束,更新關鍵字  |
| `move(step)`             | number         | 鍵盤導航移動 (+1/-1)     |
| `onEnter()`              | -              | Enter 確認選擇           |
| `applyAndGo(item, type)` | object, string | 導向蔬菜/食譜頁面        |
| `openMobileSearch()`     | -              | 開啟手機搜尋模式         |
| `closeMobileSearch()`    | -              | 關閉手機搜尋模式         |
| `toggleMenu()`           | -              | 切換手機選單             |

#### 樣式重點

- **Sticky Header**: `position: sticky; top: 0; z-index: 1000`
- **搜尋框**: 圓角膠囊造型 (`border-radius: 9999px`)
- **下拉清單**: 絕對定位,圓角陰影,最大高度 260px 可捲動
- **手機版格線佈局**: 搜尋模式下使用 `grid-template-columns`
- **響應式斷點**: `@media (max-width: 768px)`

---

### 2.2 Layout.vue

**路徑**: `src/components/Layout.vue`
**用途**: 主要頁面佈局容器,包裹 Header 與頁面內容

#### 功能特性

- 提供一致的頁面結構
- 自動引入 Header 元件
- 透過 `<slot>` 插入頁面內容
- 最大寬度限制 1320px,自動置中
- 響應式內距調整

#### Props

無

#### Slots

| Slot 名稱 | 說明         |
| --------- | ------------ |
| `default` | 頁面主要內容 |

#### 結構說明

```vue
<div class="layout-wrapper">
  <Header />
  <div class="page-container">
    <slot />  <!-- 頁面內容插入此處 -->
  </div>
</div>
```

#### 樣式重點

- **最小高度**: `min-height: 100vh` (佔滿視窗)
- **Flex 佈局**: 垂直排列 Header 與 內容
- **內容容器**: `max-width: 1320px`, 自動置中
- **響應式內距**:
  - 手機版: `padding: 0 24px`
  - 桌機版: `padding: 0px`

---

### 2.3 Footer.vue

**路徑**: `src/components/Footer.vue`
**用途**: 全站通用頁腳,包含網站資訊、快速連結、訂閱表單

#### 功能特性

1. **三欄式佈局**

   - 左欄:平台介紹
   - 中欄:快速連結
   - 右欄:訂閱價格通知表單

2. **全寬顯示**

   - 使用 CSS 技巧 (`left: 50%; margin-left: -50vw`) 佔據整個視窗寬度
   - 內容區最大寬度 1200px

3. **版權資訊**
   - 底部版權聲明
   - 與主要內容區分隔線 (`border-top`)

#### Props

無

#### 結構說明

```
┌─────────────────────────────────────────┐
│  平台介紹  │  快速連結  │  訂閱表單  │
├─────────────────────────────────────────┤
│         © 2025 版權資訊                 │
└─────────────────────────────────────────┘
```

#### 樣式重點

- **深色背景**: `background-color: #222`
- **格線佈局**: `grid-template-columns: repeat(3, 1fr)`
- **手機版**: 單欄堆疊 (`grid-template-columns: 1fr`)
- **全寬技巧**: `width: 100vw; left: 50%; margin-left: -50vw`

---

## 3. 首頁儀表板元件

### 3.1 Card.vue

**路徑**: `src/components/ConsumerHome/Card.vue`
**用途**: 通用卡片容器,為儀表板元件提供一致的外觀

#### 功能特性

- 白色背景、圓角、陰影
- 內距 padding
- 作為其他卡片元件的基礎容器

#### Props

無

#### Slots

| Slot 名稱 | 說明     |
| --------- | -------- |
| `default` | 卡片內容 |

#### 樣式重點

- `background: white`
- `border-radius: 16px`
- `box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05)`
- `padding: 20px`

---

### 3.2 BrandHeroCard.vue

**路徑**: `src/components/ConsumerHome/BrandHeroCard.vue`
**用途**: 品牌主視覺卡片,首頁頂部大型橫幅

#### 功能特性

- 大型視覺橫幅
- 顯示品牌標語/主要訊息
- 可能包含行動按鈕 (CTA)

#### Props

待確認 (依實際實作調整)

#### 樣式重點

- 大尺寸卡片
- 可能包含背景圖片或漸層

---

### 3.3 MarketTrendCard.vue

**路徑**: `src/components/ConsumerHome/MarketTrendCard.vue`
**用途**: 今日市場行情卡片,顯示蔬果價格趨勢圖表

#### 功能特性

1. **價格趨勢圖表**

   - 使用 D3.js 繪製柱狀圖
   - 綠色漸層柱狀 (linearGradient)
   - 顯示過去 7 天價格走勢
   - 響應式調整尺寸 (ResizeObserver)

2. **品項選擇**

   - 下拉選單切換不同蔬果品項
   - 自訂樣式的 `<select>` 元件

3. **即時更新按鈕**

   - 模擬即時價格更新 (±2 隨機變動)

4. **價格亮點顯示**
   - 周下跌最多
   - 周上漲最多
   - 漲幅最多

#### Props

無 (資料來自 `@/data/consumerDashboardData.js`)

#### 主要狀態

| 狀態變數       | 型別               | 說明              |
| -------------- | ------------------ | ----------------- |
| `selectedItem` | `ref<string>`      | 當前選擇的品項    |
| `chartEl`      | `ref<HTMLElement>` | 圖表 DOM 元素引用 |

#### 計算屬性

| 計算屬性    | 回傳型別 | 說明                    |
| ----------- | -------- | ----------------------- |
| `series`    | `array`  | 當前品項的 7 天價格序列 |
| `highlight` | `object` | 價格亮點資訊            |

#### 主要方法

| 方法名稱           | 參數 | 說明                  |
| ------------------ | ---- | --------------------- |
| `draw()`           | -    | 繪製/更新圖表         |
| `refresh()`        | -    | 模擬即時更新價格      |
| `ensureGradient()` | -    | 確保 SVG 漸層定義存在 |

#### D3.js 圖表規格

- **比例尺**:
  - X 軸: `d3.scaleBand()` (日期)
  - Y 軸: `d3.scaleLinear()` (價格,最大值 \* 1.2)
- **柱寬間距**: `padding(0.24)`
- **圓角**: `rx: 8`
- **動畫**: `transition().duration(450)` (進入), `300` (更新)
- **漸層**: `#22c55e` → `#16a34a`

#### 樣式重點

- **Grid 佈局**: `grid-template-rows: auto auto 1fr`
- **圖表容器**: `height: 140px`, 淺綠背景 `#eaf7ef`
- **亮點卡片**: `grid-template-columns: repeat(3, 1fr)`
- **手機版**: 單欄堆疊,圖表高度 160px

---

### 3.4 RecipeListCard.vue

**路征**: `src/components/ConsumerHome/RecipeListCard.vue`
**用途**: 首頁食譜快速列表卡片

#### 功能特性

- 顯示精選食譜清單
- 點擊導向食譜詳情頁
- 可能包含縮圖、標題、簡介

#### Props

待確認

---

### 3.5 AgriCompositeIndexCard.vue

**路徑**: `src/components/ConsumerHome/AgriCompositeIndexCard.vue`
**用途**: 農業綜合指數卡片

#### 功能特性

- 顯示農業市場綜合指標
- 可能包含數字統計、趨勢圖表

#### Props

待確認

---

### 3.6 NutritionHelperCard.vue

**路徑**: `src/components/ConsumerHome/NutritionHelperCard.vue`
**用途**: 營養小幫手卡片

#### 功能特性

- 提供營養建議/小知識
- 可能包含圖示、文字說明

#### Props

待確認

---

### 3.7 NewsCard.vue

**路徑**: `src/components/ConsumerHome/NewsCard.vue`
**用途**: 新聞動態卡片

#### 功能特性

- 顯示最新消息/公告
- 可能包含時間戳記、標題、摘要

#### Props

待確認

---

## 4. 蔬菜詳情頁元件

### 4.1 VeggieMainInfoCard.vue

**路徑**: `src/components/Veggie/VeggieMainInfoCard.vue`
**用途**: 蔬菜主要資訊卡片,顯示名稱、價格、圖片、收藏按鈕、價格警示

#### 功能特性

1. **蔬菜基本資訊**

   - 中文名稱 + 英文名稱
   - 蔬菜圖片 (綠色背景圓角)
   - 料理建議文字
   - 數據日期標註

2. **收藏功能**

   - 白色圓形按鈕,灰框
   - 未收藏:灰色愛心圖示
   - 已收藏:紅色愛心圖示
   - 點擊切換收藏狀態
   - 未登入自動導向登入頁
   - API 整合:新增/移除收藏

3. **最新均價顯示**

   - 橘色膠囊標籤
   - 動態顯示價格

4. **價格警示**

   - 超漲 ≥20%:紅色文字「價格飆漲超過 20%,建議選購替代品」
   - 超跌 ≤-20%:紫色文字「價格超跌超過 20%,建議多加購買」

5. **當季推薦徽章**

   - 桌機版:右上角徽章
   - 手機版:絕對定位徽章

6. **響應式佈局**
   - 桌機版:水平排列 (圖片 | 資訊 | 徽章)
   - 手機版:垂直堆疊,隱藏日期,顯示手機版徽章

#### Props

| Prop 名稱 | 型別     | 必填 | 說明         |
| --------- | -------- | ---- | ------------ |
| `veggie`  | `Object` | 是   | 蔬菜資料物件 |

#### veggie 物件結構

```typescript
{
  id: string,           // 蔬菜 ID (如 F001)
  foodId?: string,      // 備用 ID
  code?: string,        // 備用 ID
  name: string,         // 中文名稱
  nameEn: string,       // 英文名稱
  image: string,        // 圖片路徑
  displayPrice: number, // 最新均價
  date: string,         // 數據日期 (ISO 格式)
  cookingSuggestions: string, // 料理建議
  isFavorite?: boolean  // 初始收藏狀態 (會被伺服器狀態覆蓋)
}
```

#### 主要狀態

| 狀態變數     | 型別           | 說明         |
| ------------ | -------------- | ------------ |
| `isFavorite` | `ref<boolean>` | 收藏狀態     |
| `favBusy`    | `ref<boolean>` | 防止連點標記 |

#### 計算屬性

| 計算屬性        | 回傳型別 | 說明                    |
| --------------- | -------- | ----------------------- |
| `formattedDate` | `string` | 格式化日期 (YYYY/MM/DD) |
| `trend30`       | `array`  | 30 天價格趨勢資料       |
| `currentPrice`  | `number` | 當前價格 (最後一筆)     |
| `weekAgoPrice`  | `number` | 一週前價格 (往前 7 筆)  |
| `diffPercent`   | `number` | 漲跌百分比              |
| `adviceText`    | `string` | 警示文字 (±20% 才顯示)  |

#### 主要方法

| 方法名稱                    | 參數           | 說明                       |
| --------------------------- | -------------- | -------------------------- |
| `toggleFavorite()`          | -              | 切換收藏狀態               |
| `syncFavoriteFromServer()`  | -              | 從伺服器同步收藏狀態       |
| `favAdd(foodId, userId)`    | string, number | 新增收藏 API               |
| `favRemove(foodId, userId)` | string, number | 移除收藏 API               |
| `favStatus(foodId, userId)` | string, number | 查詢收藏狀態 API           |
| `getFoodId()`               | -              | 從 props 或路由取得蔬菜 ID |
| `getUserId()`               | -              | 取得使用者 ID              |

#### API 端點

- **新增收藏**: `POST /api/memberUser/favorites/food/{foodId}?userId={userId}`
- **移除收藏**: `DELETE /api/memberUser/favorites/food/{foodId}?userId={userId}`
- **查詢收藏清單**: `GET /api/memberUser/favorites/food?subCategory=ALL&userId={userId}`

#### 樣式重點

- **收藏按鈕**: 白色圓形 (`border-radius: 50%`), 灰框 1.5px
- **愛心圖示**: 13px × 13px
- **價格標籤**: 橘色 `#ff9800`, 圓角 999px
- **警示文字**:
  - 超跌: `color: #8d6eff`
  - 超漲: `color: #ff5a5a`
- **手機版徽章**: 絕對定位 `top: -30px; right: -20px`

---

### 4.2 AveragePriceTrendChart.vue

**路徑**: `src/components/Veggie/AveragePriceTrendChart.vue`
**用途**: 平均價格趨勢圖表 (折線圖)

#### 功能特性

- 使用 Chart.js 繪製折線圖
- 顯示 7 天/30 天/全年度價格趨勢
- 切換時間區間
- 響應式尺寸調整

#### Props

待確認

#### 圖表規格

- **類型**: Line Chart (Chart.js)
- **X 軸**: 日期
- **Y 軸**: 價格 (元)
- **線條**: 綠色漸層

---

### 4.3 MultiMarketPriceCompareCard.vue

**路徑**: `src/components/Veggie/MultiMarketPriceCompareCard.vue`
**用途**: 多市場價格比較卡片

#### 功能特性

- 列表顯示不同市場價格
- 視覺化價格差異 (可能使用柱狀圖或列表)
- 市場名稱、價格、漲跌幅

#### Props

待確認

---

### 4.4 NutritionInfoCard.vue

**路徑**: `src/components/Veggie/NutritionInfoCard.vue`
**用途**: 營養資訊卡片

#### 功能特性

- 顯示蔬菜營養成分
- 可能包含:熱量、蛋白質、脂肪、碳水化合物、纖維、維生素等
- 視覺化呈現 (圓餅圖/條狀圖)

#### Props

待確認

---

### 4.5 SimilarVeggieCompareCard.vue

**路徑**: `src/components/Veggie/SimilarVeggieCompareCard.vue`
**用途**: 類似蔬菜比較卡片

#### 功能特性

- 顯示相似蔬菜
- 價格比較
- 營養比較
- 點擊導向其他蔬菜頁面

#### Props

待確認

---

### 4.6 RecipeRecommendCard.vue

**路徑**: `src/components/Veggie/RecipeRecommendCard.vue`
**用途**: 相關食譜推薦卡片

#### 功能特性

- 顯示使用該蔬菜的食譜
- 食譜縮圖、名稱
- 點擊導向食譜詳情頁

#### Props

待確認

---

### 4.7 StorageTipsCard.vue

**路徑**: `src/components/Veggie/StorageTipsCard.vue`
**用途**: 保存方式建議卡片

#### 功能特性

- 顯示蔬菜保存技巧
- 圖示 + 文字說明
- 保存期限、溫度、方法

#### Props

待確認

---

### 4.8 AiSuggestionCard.vue

**路徑**: `src/components/Veggie/AiSuggestionCard.vue`
**用途**: AI 建議卡片

#### 功能特性

- AI 生成的購買建議
- 料理建議
- 替代品推薦

#### Props

待確認

---

### 4.9 FarmerInfoCard.vue

**路徑**: `src/components/Veggie/FarmerInfoCard.vue`
**用途**: 農民資訊卡片

#### 功能特性

- 顯示供應農民資訊
- 農場名稱、產地、認證標章
- 可能包含聯絡資訊

#### Props

待確認

---

## 5. 食譜詳情頁元件

### 5.1 RecipeDetailHeader.vue

**路徑**: `src/components/Recipe/RecipeDetailHeader.vue`
**用途**: 食譜詳情頁頂部橫幅,包含標題、描述、圖片、收藏按鈕、基本資訊

#### 功能特性

1. **動態漸層背景**

   - 使用 CSS 變數動態注入漸層顏色
   - 桌機版:水平漸層 (90deg)
   - 手機版:垂直漸層 (to bottom)
   - 透明漸層淡出效果

2. **食譜基本資訊**

   - 標題 (可截斷 ellipsis)
   - 描述文字
   - 烹飪時間 (分鐘)
   - 份量 (人份)
   - 難度標示
   - 資訊圖示

3. **收藏功能**

   - 白色圓形按鈕,與蔬菜頁一致
   - 未收藏:灰色愛心
   - 已收藏:紅色愛心
   - 點擊切換收藏狀態
   - 未登入自動導向登入頁
   - API 整合:新增/移除收藏

4. **響應式佈局**
   - 桌機版:左側文字 + 右側圖片,水平漸層
   - 手機版:上下堆疊,垂直漸層

#### Props

| Prop 名稱         | 型別            | 必填 | 預設值 | 說明                  |
| ----------------- | --------------- | ---- | ------ | --------------------- |
| `id`              | `String/Number` | 否   | -      | 食譜 ID               |
| `title`           | `String`        | 否   | -      | 食譜標題              |
| `desc`            | `String`        | 否   | -      | 食譜描述              |
| `image`           | `String`        | 否   | -      | 食譜圖片路徑          |
| `cookTimeMinutes` | `Number/String` | 否   | `null` | 烹飪時間 (分鐘)       |
| `servings`        | `Number/String` | 否   | `null` | 份量 (人份)           |
| `difficulty`      | `String`        | 否   | -      | 難度 (簡單/中等/困難) |
| `gradientColors`  | `Array`         | 否   | `[]`   | 漸層顏色陣列 (3 色)   |

#### gradientColors 格式

```javascript
// 範例
gradientColors: ["#ff6b6b", "#ff8e53", "#ffa500"];
```

#### 主要狀態

| 狀態變數     | 型別           | 說明         |
| ------------ | -------------- | ------------ |
| `isFavorite` | `ref<boolean>` | 收藏狀態     |
| `favBusy`    | `ref<boolean>` | 防止連點標記 |

#### 計算屬性

| 計算屬性        | 回傳型別 | 說明         |
| --------------- | -------- | ------------ |
| `gradientStyle` | `string` | CSS 漸層字串 |

#### 主要方法

| 方法名稱                   | 參數 | 說明                       |
| -------------------------- | ---- | -------------------------- |
| `toggleFavorite()`         | -    | 切換收藏狀態               |
| `syncFavoriteFromServer()` | -    | 從伺服器同步收藏狀態       |
| `generateGradientCSS()`    | -    | 生成桌機/手機漸層 CSS 變數 |
| `getRecipeId()`            | -    | 從 props 或路由取得食譜 ID |
| `getUserId()`              | -    | 取得使用者 ID              |

#### API 端點

- **新增收藏**: `POST /api/memberUser/favorites/recipe/{recipeId}?userId={userId}`
- **移除收藏**: `DELETE /api/memberUser/favorites/recipe/{recipeId}?userId={userId}`
- **查詢收藏清單**: `GET /api/memberUser/favorites/recipe?category=ALL&userId={userId}`

#### 樣式重點

- **容器**: `border-radius: 24px`, `min-height: 150px`
- **漸層層**: 絕對定位 `inset: 0`, `z-index: 1`
- **文字區**: 相對定位 `z-index: 2`, `padding: 32px 40px`
- **圖片**: `object-fit: cover`, `max-width: 400px`
- **收藏按鈕**: 36px × 36px, 白色圓形, 灰框 1.5px
- **愛心圖示**: 18px × 18px
- **手機版**: `flex-direction: column`, `padding: 24px 16px`

---

### 5.2 IngredientsList.vue

**路徑**: `src/components/Recipe/IngredientsList.vue`
**用途**: 食材清單元件

#### 功能特性

- 列表顯示食材名稱 + 用量
- 可能包含分類 (主食材/調味料)
- Checkbox 功能 (勾選已備妥)

#### Props

待確認

---

### 5.3 MainIngredientPrice.vue

**路徑**: `src/components/Recipe/MainIngredientPrice.vue`
**用途**: 主要食材價格卡片

#### 功能特性

- 顯示主要食材當前價格
- 價格趨勢箭頭 (↑/↓)
- 點擊導向蔬菜詳情頁

#### Props

待確認

---

### 5.4 MainNutritionCard.vue

**路徑**: `src/components/Recipe/MainNutritionCard.vue`
**用途**: 營養成分卡片

#### 功能特性

- 顯示食譜營養資訊
- 熱量、蛋白質、脂肪、碳水化合物等
- 視覺化圓餅圖或條狀圖

#### Props

待確認

---

### 5.5 RecipeSteps.vue

**路徑**: `src/components/Recipe/RecipeSteps.vue`
**用途**: 料理步驟元件

#### 功能特性

- 步驟編號 + 說明文字
- 步驟圖片 (可選)
- 時間標註
- Checkbox 功能 (勾選已完成)

#### Props

待確認

---

### 5.6 SubstituteRecommendations.vue

**路徑**: `src/components/Recipe/SubstituteRecommendations.vue`
**用途**: 替代食材推薦卡片

#### 功能特性

- 顯示可替代的食材
- 替代原因 (價格/營養/季節)
- 點擊查看替代品詳情

#### Props

待確認

---

### 5.7 MarketTrends.vue

**路徑**: `src/components/Recipe/MarketTrends.vue`
**用途**: 食材市場趨勢卡片

#### 功能特性

- 顯示食材價格走勢
- 可能使用 Chart.js 折線圖
- 價格預測

#### Props

待確認

---

### 5.8 SeasonalRecommend.vue

**路徑**: `src/components/Recipe/SeasonalRecommend.vue`
**用途**: 當季推薦卡片

#### 功能特性

- 顯示當季食材
- 當季食譜推薦
- 季節標章

#### Props

待確認

---

## 6. 共用元件

### 6.1 RecipeCard.vue

**路徑**: `src/components/CCC/RecipeList/RecipeCard.vue`
**用途**: 食譜卡片元件,用於食譜列表頁展示

#### 功能特性

1. **食譜資訊展示**

   - 食譜圖片 (200px 高度)
   - 食譜標題 (最多 2 行截斷)
   - 食譜描述 (最多 2 行截斷)
   - 難度、時間、份量資訊列
   - 標籤列 (素食、簡單、烘焙等)

2. **推薦標籤**

   - 推薦食譜顯示綠色「推薦」徽章
   - 絕對定位於右上角

3. **圖片載入管理**

   - 載入狀態:顯示「載入中...」
   - 錯誤狀態:顯示圖示 + 「圖片載入失敗」
   - 失敗後直接顯示錯誤,不重試

4. **互動效果**

   - Hover 浮起效果 (`translateY(-4px)`)
   - Hover 圖片放大 (`scale(1.05)`)
   - 點擊卡片導向食譜詳情頁

5. **標籤色彩系統**
   - 素食:綠色 `#e8f5e8`
   - 簡單:橘色 `#fff3e0`
   - 烘焙:粉色 `#fce4ec`
   - 甜點:紫色 `#f3e5f5`
   - 辣味:紅色 `#ffebee`
   - 湯品:藍色 `#e3f2fd`
   - 預設:灰色 `#f5f5f5`

#### Props

| Prop 名稱 | 型別     | 必填 | 說明         |
| --------- | -------- | ---- | ------------ |
| `recipe`  | `Object` | 是   | 食譜資料物件 |

#### recipe 物件結構

```typescript
{
  id: string,             // 食譜 ID (如 R001)
  name: string,           // 食譜名稱
  description: string,    // 食譜描述
  image: string,          // 圖片路徑
  difficulty: string,     // 難度 (簡單/中等/困難)
  cookTime: string,       // 烹飪時間 (如 "30分鐘")
  servings: number,       // 份量 (人數)
  tags: string[],         // 標籤陣列
  isRecommended?: boolean // 是否推薦
}
```

#### 主要狀態

| 狀態變數          | 型別           | 說明             |
| ----------------- | -------------- | ---------------- |
| `imageLoading`    | `ref<boolean>` | 圖片載入中       |
| `imageErrorCount` | `ref<number>`  | 圖片錯誤計數     |
| `maxRetries`      | `number`       | 最大重試次數 (3) |

#### 主要方法

| 方法名稱                  | 參數   | 說明             |
| ------------------------- | ------ | ---------------- |
| `goToDetail()`            | -      | 導向食譜詳情頁   |
| `handleImageLoad()`       | -      | 圖片載入成功處理 |
| `handleImageError(event)` | Event  | 圖片載入失敗處理 |
| `getTagClass(tag)`        | string | 取得標籤樣式類別 |

#### 樣式重點

- **卡片**: `border-radius: 12px`, 白色背景, 陰影
- **圖片容器**: 固定高度 200px, `object-fit: cover`
- **內容區**: `padding: 20px`, `min-height: 200px`
- **資訊列**: `display: flex; justify-content: space-between`
- **標籤列**: `display: flex; flex-wrap: wrap; gap: 6px`
- **手機版**: 圖片高度 160px, 內容區 padding 16px

---

### 6.2 CategoryTag.vue

**路徑**: `src/components/CCC/CategoryTag.vue`
**用途**: 分類標籤元件

#### 功能特性

- 顯示分類名稱
- 可點擊篩選
- 選中狀態視覺回饋

#### Props

待確認

---

### 6.3 RecipeCategoryTags.vue

**路徑**: `src/components/CCC/RecipeList/RecipeCategoryTags.vue`
**用途**: 食譜分類標籤列

#### 功能特性

- 顯示多個分類標籤
- 點擊篩選食譜
- 選中/未選中狀態

#### Props

待確認

---

### 6.4 RecipeSideBar.vue

**路徑**: `src/components/CCC/RecipeList/RecipeSideBar.vue`
**用途**: 食譜列表側邊欄

#### 功能特性

- 篩選器:分類、難度、時間、份量
- 排序選項
- 搜尋框

#### Props

待確認

---

### 6.5 Recommendation.vue

**路徑**: `src/components/CCC/RecipeList/Recommendation.vue`
**用途**: 推薦食譜區塊

#### 功能特性

- 顯示推薦食譜
- 輪播或卡片列表

#### Props

待確認

---

### 6.6 PageControls.vue

**路徑**: `src/components/CCC/PageControls.vue`
**用途**: 分頁控制元件

#### 功能特性

- 上一頁/下一頁按鈕
- 頁碼選擇
- 總頁數顯示

#### Props

待確認

---

### 6.7 PageHeader.vue

**路徑**: `src/components/CCC/PageHeader.vue`
**用途**: 頁面標題元件

#### 功能特性

- 顯示頁面標題
- 麵包屑導航
- 副標題/描述

#### Props

待確認

---

### 6.8 Sidebar.vue

**路徑**: `src/components/CCC/Sidebar.vue`
**用途**: 通用側邊欄元件

#### 功能特性

- 篩選選項
- 導航連結
- 可摺疊/展開

#### Props

待確認

---

### 6.9 MarketSight.vue

**路徑**: `src/components/CCC/MarketSight.vue`
**用途**: 市場概覽元件

#### 功能特性

- 市場趨勢摘要
- 重要指標顯示

#### Props

待確認

---

### 6.10 RoleToggle.vue

**路徑**: `src/components/RoleToggle.vue`
**用途**: 角色切換按鈕

#### 功能特性

- 消費者/農民角色切換
- 切換後導向對應首頁
- 更新 Pinia store

#### Props

待確認

---

## 7. 技術規格說明

### 7.1 全域工具與插件

#### 7.1.1 圖片解析工具 $img

**位置**: `src/utils/resolveImg.js`
**註冊**: `app.config.globalProperties.$img`

**功能**: 統一處理圖片路徑,支援相對路徑、絕對路徑、外部 URL

**使用方式**:

```vue
<img :src="$img(recipe.image)" alt="圖片" />
```

**解析邏輯**:

1. 若為絕對路徑 (http/https):直接回傳
2. 若以 `/assets` 開頭:使用 Vite `new URL(..., import.meta.url).href`
3. 其他:嘗試從 `@/assets/` 引入,失敗則回傳原路徑

---

### 7.2 狀態管理 (Pinia)

#### 7.2.1 User Store

**位置**: `src/store/user.js`

**狀態**:

```javascript
{
  token: string,           // JWT Token
  userId: number,          // 使用者 ID
  userName: string,        // 使用者名稱
  userRole: string,        // 角色 (consumer/farmer)
  userInfo: object,        // 其他使用者資訊
}
```

**計算屬性**:

- `isAuthenticated`: 是否已登入 (token && userId && userName)

**Actions**:

- `login({ token, userId, userName, role })`: 登入
- `logout()`: 登出,清空 localStorage
- `updateUserInfo(info)`: 更新使用者資訊

**持久化**: 使用 `localStorage` 儲存 token, userId, userName, userRole

---

### 7.3 API 整合

#### 7.3.1 Axios 客戶端

**位置**: `src/api/client.js`

**功能**:

- 統一 API base URL (`https://freshlog-api.ttshow.tw`)
- Request Interceptor:自動注入 JWT Token
- Response Interceptor:錯誤處理,401 自動登出
- 支援 Query Parameters + Body Parameters

**使用範例**:

```javascript
import { apiFetch } from "@/api/client.js";

const data = await apiFetch("POST", "/api/recipe/findRecipesList", {
  body: { category: "ALL", page: 1, size: 10 },
  query: { sort: "newest" },
});
```

---

### 7.4 路由配置

**位置**: `src/router/index.js`

**主要路由**:

| 路徑                     | 元件                 | 說明                |
| ------------------------ | -------------------- | ------------------- |
| `/`                      | `Home.vue`           | 首頁 (角色判斷)     |
| `/select-role`           | `RoleSelect.vue`     | 角色選擇            |
| `/recipes`               | `RecipeListPage.vue` | 食譜列表            |
| `/ai-recommendation/:id` | `RecipeDetail.vue`   | 食譜詳情            |
| `/veggie/:id`            | `VeggieInfoPage.vue` | 蔬菜詳情            |
| `/member/login`          | `Login.vue`          | 登入                |
| `/member/register`       | `Register.vue`       | 註冊                |
| `/member/profile`        | `Profile.vue`        | 個人中心 (需登入)   |
| `/member/follows`        | `MyFollows.vue`      | 追蹤清單 (需登入)   |
| `/farmer/crop-dashboard` | `CropDashboard.vue`  | 農民儀表板 (需登入) |

**路由守衛**:

```javascript
router.beforeEach((to, from, next) => {
  const userStore = useUserStore();
  const requiresAuth = to.meta.requiresAuth;

  if (requiresAuth && !userStore.isAuthenticated) {
    localStorage.setItem("redirectAfterLogin", to.fullPath);
    return next("/member/login");
  }
  next();
});
```

---

### 7.5 響應式設計規範

#### 斷點定義

- **手機版**: `max-width: 768px`
- **平板版**: `min-width: 769px` and `max-width: 1024px`
- **桌機版**: `min-width: 1025px`

#### 容器最大寬度

- Header/Footer 內容區: `1200px`
- 頁面主要內容: `1320px`

#### 字體大小範例

| 元素      | 桌機版 | 手機版 |
| --------- | ------ | ------ |
| 網站標題  | 22px   | 18px   |
| 卡片標題  | 22px   | 18px   |
| 食譜標題  | 18px   | 16px   |
| 內文      | 16px   | 14px   |
| 小字/標籤 | 14px   | 12px   |

---

### 7.6 收藏功能整合規範

#### 整合流程

1. **初始化**:

   - 元件掛載時,若使用者已登入,呼叫清單端點同步伺服器狀態
   - `onMounted(syncFavoriteFromServer)`

2. **點擊收藏**:

   - 未登入:導向登入頁,記錄 `redirectAfterLogin`
   - 已登入:
     - 樂觀更新 UI (`isFavorite.value = !isFavorite.value`)
     - 呼叫新增/移除 API
     - 成功:顯示成功訊息
     - 失敗:回滾狀態,顯示錯誤訊息

3. **狀態同步**:
   - 監聽 `userStore.isAuthenticated`, `route.fullPath`, `props.id`
   - 任一改變時重新同步伺服器狀態

#### API 回應碼規範

| 回應碼      | 說明     | 處理方式           |
| ----------- | -------- | ------------------ |
| `0000`, `0` | 成功     | 視為成功           |
| `2001`      | 已收藏過 | 新增收藏時視為成功 |
| `2002`      | 不存在   | 移除收藏時視為成功 |
| `401`       | 未授權   | 導向登入頁         |
| 其他        | 錯誤     | 顯示錯誤訊息       |

---

### 7.7 圖表元件規範

#### 7.7.1 D3.js 圖表 (MarketTrendCard)

- **版本**: D3.js v7.9.0
- **響應式**: 使用 `ResizeObserver` 監聽容器尺寸變化
- **動畫**: `transition().duration(300~450)`
- **漸層**: 使用 `<defs><linearGradient>` 定義 SVG 漸層

#### 7.7.2 Chart.js 圖表 (AveragePriceTrendChart)

- **版本**: Chart.js v4.4.9
- **圖表類型**: Line Chart
- **配置**: 綠色線條,網格線,工具提示

---

### 7.8 環境變數

**檔案**: `.env`

```env
VITE_API_BASE_URL=https://freshlog-api.ttshow.tw
VITE_ASSET_BASE=https://freshlog-api.ttshow.tw
```

**使用方式**:

```javascript
const apiBase = import.meta.env.VITE_API_BASE_URL;
```

---

### 7.9 建置與部署

#### 開發環境

```bash
npm run dev
```

- 啟動 Vite 開發伺服器
- 預設埠號: 5173
- 熱模組替換 (HMR)

#### 生產建置

```bash
npm run build
```

- 輸出目錄: `dist/`
- 最佳化與壓縮
- Tree-shaking

#### 預覽建置

```bash
npm run preview
```

- 本地預覽生產版本

#### 部署平台

- **Vercel**: 使用 `vercel.json` 配置
- SPA 路由支援:所有路徑重寫至 `/index.html`

---

## 8. 附錄

### 8.1 依賴套件清單

#### 生產依賴

| 套件名稱       | 版本    | 用途                       |
| -------------- | ------- | -------------------------- |
| `vue`          | ^3.5.13 | Vue 框架                   |
| `vue-router`   | ^4.5.0  | 路由管理                   |
| `pinia`        | ^3.0.1  | 狀態管理                   |
| `axios`        | ^1.8.4  | HTTP 客戶端                |
| `chart.js`     | ^4.4.9  | 圖表庫 (Chart.js)          |
| `d3`           | ^7.9.0  | 資料視覺化庫 (D3.js)       |
| `@vueuse/core` | ^13.1.0 | Vue Composition API 工具集 |
| `express`      | ^5.1.0  | Mock 伺服器                |
| `cors`         | ^2.8.5  | CORS 中介軟體              |
| `env-cmd`      | ^10.1.0 | 環境變數管理               |

#### 開發依賴

| 套件名稱             | 版本   | 用途          |
| -------------------- | ------ | ------------- |
| `vite`               | ^6.2.0 | 建置工具      |
| `@vitejs/plugin-vue` | ^5.2.1 | Vite Vue 插件 |

---

### 8.2 瀏覽器支援

- **Chrome**: 最新版 + 前兩個主要版本
- **Firefox**: 最新版 + 前兩個主要版本
- **Safari**: 最新版 + 前兩個主要版本
- **Edge**: 最新版 + 前兩個主要版本
- **行動瀏覽器**: iOS Safari 12+, Android Chrome 90+

---

### 8.3 圖示資源清單

| 圖示檔案              | 用途              |
| --------------------- | ----------------- |
| `heart-gray.png`      | 未收藏愛心        |
| `heart-red.png`       | 已收藏愛心        |
| `clock.png`           | 時鐘圖示          |
| `timing.png`          | 計時圖示          |
| `difficulty.png`      | 難度圖示          |
| `chart.png`           | 圖表圖示          |
| `carrot.png`          | 紅蘿蔔圖示        |
| `location.png`        | 位置圖示          |
| `nutrition.png`       | 營養圖示          |
| `quantity.png`        | 份量圖示          |
| `flame.png`           | 烹飪方式圖示      |
| `recipetime.png`      | 食譜時間圖示      |
| `magnifier-icon.png`  | 搜尋放大鏡        |
| `user-icon-white.png` | 使用者圖示 (白色) |
| `season-badge.png`    | 當季推薦徽章      |
| `google-icon.png`     | Google 登入圖示   |
| `logo.png`            | 網站 Logo         |

---

### 8.4 色彩規範

#### 主要色彩

| 色彩名稱 | Hex 值    | 用途             |
| -------- | --------- | ---------------- |
| 主綠色   | `#2e7d32` | 主色調,按鈕,連結 |
| 次綠色   | `#22c55e` | 圖表漸層起點     |
| 深綠色   | `#16a34a` | 圖表漸層終點     |
| 橘色     | `#ff9800` | 價格標籤         |
| 紅色     | `#ff5a5a` | 超漲警示         |
| 紫色     | `#8d6eff` | 超跌警示         |

#### 語意色彩

| 語意 | Hex 值    | 用途     |
| ---- | --------- | -------- |
| 成功 | `#4caf50` | 推薦徽章 |
| 警告 | `#ff9800` | 價格標籤 |
| 錯誤 | `#d32f2f` | 錯誤訊息 |
| 資訊 | `#1976d2` | 資訊提示 |

#### 中性色彩

| 色彩名稱 | Hex 值    | 用途     |
| -------- | --------- | -------- |
| 背景灰   | `#f9f9f9` | 頁面背景 |
| 淺灰     | `#f5f5f5` | 卡片背景 |
| 中灰     | `#ccc`    | 邊框     |
| 深灰     | `#666`    | 次要文字 |
| 黑色     | `#333`    | 主要文字 |

---

### 8.5 命名慣例

#### 元件檔案命名

- **格式**: PascalCase (大寫駝峰)
- **範例**: `RecipeDetailHeader.vue`, `VeggieMainInfoCard.vue`

#### 變數/函數命名

- **格式**: camelCase (小寫駝峰)
- **範例**: `isFavorite`, `toggleFavorite`, `syncFavoriteFromServer`

#### CSS 類別命名

- **格式**: kebab-case (短橫線)
- **範例**: `recipe-card`, `header-title`, `search-dd__item`

#### 常數命名

- **格式**: UPPER_SNAKE_CASE (大寫蛇形)
- **範例**: `API_BASE`, `CODE_OK`, `MAX_RETRIES`

---

### 8.6 Git 提交訊息規範

建議使用 Conventional Commits 格式:

```
<type>(<scope>): <subject>

<body>

<footer>
```

**類型 (type)**:

- `feat`: 新功能
- `fix`: 修復 Bug
- `docs`: 文件變更
- `style`: 程式碼格式 (不影響功能)
- `refactor`: 重構
- `test`: 測試
- `chore`: 建置/工具變更

**範例**:

```
feat(recipe): add favorite button to recipe detail header

- Implement favorite toggle functionality
- Integrate with backend API
- Add loading state and error handling
```

---

## 9. 更新記錄

| 版本   | 日期       | 更新內容                      |
| ------ | ---------- | ----------------------------- |
| v1.0.0 | 2025-10-27 | 初版完成,包含全部元件規格描述 |

---

**文件結束**
